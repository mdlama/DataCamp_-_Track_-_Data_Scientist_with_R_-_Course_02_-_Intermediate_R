---
title: "Intermediate R"
author: "M. Drew LaMar (modified from [Luka Ignjatovi&#263;](https://github.com/LukaIgnjatovic))"
output: 
  learnr::tutorial:
    progressive: true
    allow_skip: true
runtime: shiny_prerendered
description: "Intermediate R is the next stop on your journey in mastering the R programming language. In this R training, you will learn about conditional statements, loops, and functions to power your own R scripts. Next, make your R code more efficient and readable using the apply functions. Finally, the utilities chapter gets you up to speed with regular expressions in R, data structure manipulations, and times and dates. This course will allow you to take the next step in advancing your overall knowledge and capabilities while programming in R."
---

```{r setup, include=FALSE}
library(learnr)
library(gradethis)
gradethis_setup()
```

## Conditionals and control flow {data-progressive=TRUE}

To be TRUE or not be TRUE, that's the question. In this chapter you'll learn about relational operators to see how R objects compare and logical operators to combine logicals. Next, you'll use this knowledge to build conditional statements.

<div align="middle">

> **Document:** ["Slides - Conditional and control flows"](./Slides/Chapter 01 - Conditional and control flows.pdf)

</div>

<div align="middle">

<!-- <video width="80%" controls src="./Videos/Chapter 01 - Lecture 01 - Relational operators.mp4" type="video/mp4"/> -->

</div>

### Equality

The most basic form of comparison is equality. Let's briefly recap its syntax. The following statements all evaluate to `TRUE` (feel free to run the code).

```{r truthiness, exercise=TRUE}
3 == (2 + 1)
"intermediate" != "r"
TRUE != FALSE
"Rchitect" != "rchitect"
```

Notice from the last expression that R is case sensitive: "R" is not equal to "r". Keep this in mind when solving the exercises in this chapter!

#### Exercise 1: Comparison of logicals
*Write R code to see if* `TRUE` *equals* `FALSE`*.*

```{r truthiness-ex-1, exercise=TRUE}
# Comparison of logicals

```

```{r truthiness-ex-1-solution}
TRUE == FALSE
```

```{r truthiness-ex-1-check}
grade_code()
```

#### Exercise 2: Comparison of numerics
*Check if* `-6 * 14` *is not equal to* `17 - 101`*.*

```{r truthiness-ex-2, exercise=TRUE}

```

```{r truthiness-ex-2-solution}
-6 * 14 != 17 - 101
```

```{r truthiness-ex-2-check}
grade_code()
```

#### Exercise 3: Comparison of character strings
*Compare character strings by asking R whether the strings* `"useR"` *and* `"user"` *are equal.*

```{r truthiness-ex-3, exercise=TRUE}

```

```{r truthiness-ex-3-solution}
"useR" == "user"
```

```{r truthiness-ex-3-check}
grade_code()
```

#### Exercise 4: Compare a logical with a numeric
*Find out what happens if you compare logicals to numerics: are* `TRUE` *and* `1` *equal?*

```{r truthiness-ex-4, exercise=TRUE}

```

```{r truthiness-ex-4-solution}
TRUE == 1
```

```{r truthiness-ex-4-check}
grade_code("Since `TRUE` coerces to `1` under the hood, `TRUE == 1` evaluates to `TRUE`. Make sure not to mix up `==` (comparison) and `=` (assignment), `==` is needed to check the equality of R objects.")
```

### Greater and less than

Apart from equality operators, we also introduced the less than and greater than operators: `<` and `>`. You can also add an equal sign to express less than or equal to or greater than or equal to, respectively. Have a look at the following R expressions, that all evaluate to `FALSE`:

```{r grtorequ, exercise=TRUE}
(1 + 2) > 4
"dog" < "Cats"
TRUE <= FALSE
```

Remember that for string comparison, R determines the greater than relationship based on alphabetical order. Also, keep in mind that `TRUE` corresponds to `1` in R, and `FALSE` coerces to `0` behind the scenes. Therefore, `FALSE < TRUE` is `TRUE`.

#### Exercise 1: Comparison of numerics
*Write R code to check whether* `-6 * 5 + 2` *is greater than or equal to* `-10 + 1`*.*

```{r grtorequ-ex-1, exercise=TRUE}

```

```{r grtorequ-ex-1-solution}
-6 * 5 + 2 >= -10 + 1
```

```{r grtorequ-ex-1-check}
grade_code()
```

#### Exercise 2: Comparison of character strings
*Write R code to check whether* `"raining"` *is less than or equal to* `"raining dogs"`*.*

```{r grtorequ-ex-2, exercise=TRUE}

```

```{r grtorequ-ex-2-solution}
"raining" <= "raining dogs"
```

```{r grtorequ-ex-2-check}
grade_code()
```

#### Exercise 3: Comparison of logicals
*Write R code to check whether* `TRUE` *is greater than* `FALSE`*.*

```{r grtorequ-ex-3, exercise=TRUE}

```

```{r grtorequ-ex-3-solution}
TRUE > FALSE
```

```{r grtorequ-ex-3-check}
grade_code("Make sure to have a look at the console output to see if R returns the results you expected.")
```

### Compare vectors

You are already aware that R is very good with vectors. Without having to change anything about the syntax, R's relational operators also work on vectors.

Let's go back to the example that was started in the video. You want to figure out whether your activity on social media platforms have paid off and decide to look at your results for LinkedIn and Facebook. The code below initializes the vectors `linkedin` and `facebook`. Each of the vectors contains the number of profile views your LinkedIn and Facebook profiles had over the last seven days.

```{r compare-vecs-setup}
# The linkedin and facebook vectors have already been created for you
linkedin <- c(16, 9, 13, 5, 2, 17, 14)
facebook <- c(17, 7, 5, 16, 8, 13, 14)
```

For the following exercises, the vectors `linkedin` and `facebook` will be already initialized and available in memory.

#### Exercise 1: Popular days
*Using relational operators, find a logical answer, i.e.* `TRUE` *or* `FALSE`*, for the following questions: On which days did the number of LinkedIn profile views exceed 15?*

```{r compare-vecs-ex-1, exercise=TRUE, exercise.setup="compare-vecs-setup"}

```

```{r compare-vecs-ex-1-solution}
linkedin > 15
```

```{r compare-vecs-ex-1-check}
grade_code()
```

#### Exercise 2: Quiet days 
*Using relational operators, find a logical answer, i.e.* `TRUE` *or* `FALSE`*, for the following questions: When was your LinkedIn profile viewed only 5 times or fewer?*

```{r compare-vecs-ex-2, exercise=TRUE, exercise.setup="compare-vecs-setup"}

```

```{r compare-vecs-ex-2-solution}
linkedin <= 5
```

```{r compare-vecs-ex-2-check}
grade_code()
```

#### Exercise 3: LinkedIn more popular than Facebook
*Using relational operators, find a logical answer, i.e.* `TRUE` *or* `FALSE`*, for the following questions: When was your LinkedIn profile visited more often than your Facebook profile?*

```{r compare-vecs-ex-3, exercise=TRUE, exercise.setup="compare-vecs-setup"}

```

```{r compare-vecs-ex-3-solution}
linkedin > facebook
```

```{r compare-vecs-ex-3-check}
grade_code("Have a look at the console output. Your LinkedIn profile was pretty popular on the sixth day, but less so on the fourth and fifth day.")
```

### Compare matrices

R's ability to deal with different data structures for comparisons does not stop at vectors. Matrices and relational operators also work together seamlessly!

Instead of in vectors (as in the previous exercise), the LinkedIn and Facebook data is now stored in a matrix called `views`. The first row contains the LinkedIn information; the second row the Facebook information. The original vectors `facebook` and `linkedin` are still available as well.

```{r compare-mats-setup}
# The social data has been created for you
linkedin <- c(16, 9, 13, 5, 2, 17, 14)
facebook <- c(17, 7, 5, 16, 8, 13, 14)
views <- matrix(c(linkedin, facebook), nrow = 2, byrow = TRUE)
```

#### Exercise 1: When does views equal 13?
*Using the relational operators you've learned so far, try to discover the following: When were the views exactly equal to 13? Use the* `views` *matrix to return a logical matrix.*

```{r compare-mats-ex-1, exercise=TRUE, exercise.setup="compare-mats-setup"}

```

```{r compare-mats-ex-1-solution}
views == 13
```

```{r compare-mats-ex-1-check}
grade_code()
```

#### Exercise 2: When is views less than or equal to 14?
*Using the relational operators you've learned so far, try to discover the following: For which days were the number of views less than or equal to 14? Again, have R return a logical matrix.*

```{r compare-mats-ex-2, exercise=TRUE, exercise.setup="compare-mats-setup"}

```

```{r compare-mats-ex-2-solution}
views <= 14
```

```{r compare-mats-ex-2-check}
grade_code("This exercise concludes the part on comparators. Now that you know how to query the relation between R objects, the next step will be to use the results to alter the behavior of your programs. Find out all about that in the next video!")
```

<div align="middle">

<!-- <video width="80%" controls src="./Videos/Chapter 01 - Lecture 02 - Logical operators.mp4" type="video/mp4" /> -->

</div>

### & and |

Before you work your way through the next exercises, have a look at the following R expressions. All of them will evaluate to `TRUE`:

```{r and-or, exercise=TRUE}
TRUE & TRUE
FALSE | TRUE
5 <= 5 & 2 < 3
3 < 4 | 7 < 6
```

**Watch out**: `3 < x < 7` to check if `x` is between 3 and 7 will not work; you'll need `3 < x & x < 7` for that.

In this exercise, you'll be working with the `last` variable. This variable equals the last value of the `linkedin` vector that you've worked with previously. The `linkedin` vector represents the number of LinkedIn views your profile had in the last seven days, remember? Both the variables `linkedin` and `last` have already been defined in the editor.

```{r and-or-setup}
# The linkedin and last variable are already defined for you
linkedin <- c(16, 9, 13, 5, 2, 17, 14)
last <- tail(linkedin, 1)
```

#### Exercise 1: Is last under 5 or above 10?
*Write R code to determine if* `last` *is under 5 or above 10.*

```{r and-or-ex-1, exercise=TRUE, exercise.setup="and-or-setup"}

```

```{r and-or-ex-1-solution}
last < 5 | last > 10
```

```{r and-or-ex-1-check}
grade_code()
```

#### Exercise 2: Is last between 15 (exclusive) and 20 (inclusive)?
*Write R code to determine if* `last` *is between 15 and 20 (excluding 15 but including 20).*

```{r and-or-ex-2, exercise=TRUE, exercise.setup="and-or-setup"}

```

```{r and-or-ex-2-solution}
last > 15 & last <= 20
```

```{r and-or-ex-2-check}
grade_code("Have one last look at the console before proceeding; do the results of the different expressions make sense?")
```

### & and | (2)

Like relational operators, logical operators work perfectly fine with vectors and matrices.

Both the vectors `linkedin` and `facebook` are available again. Also a matrix - `views` - has been defined; its first and second row correspond to the `linkedin` and `facebook` vectors, respectively. Ready for some advanced queries to gain more insights into your social outreach?

```{r and-or-vec-mat-setup}
# The social data (linkedin, facebook, views) has been created for you
linkedin <- c(16, 9, 13, 5, 2, 17, 14)
facebook <- c(17, 7, 5, 16, 8, 13, 14)
views <- matrix(c(linkedin, facebook), nrow = 2, byrow = TRUE)
```

#### Exercise 1: `linkedin` exceeds 10 but `facebook` below 10
*When did LinkedIn views exceed 10 and did Facebook views fail to reach 10 for a particular day? Use the* `linkedin` *and* `facebook` *vectors.*

```{r and-or-vec-mat-ex-1, exercise=TRUE, exercise.setup="and-or-vec-mat-setup"}

```

```{r and-or-vec-mat-ex-1-solution}
linkedin > 10 & facebook < 10
```

```{r and-or-vec-mat-ex-1-check}
grade_code("You'll have noticed how easy it is to use logical operators to vectors and matrices. What do these results tell us? The third day of the recordings was the only day where your LinkedIn profile was visited more than 10 times, while your Facebook profile wasn't. Can you draw similar conclusions for the results of the next two exercises?")
```

#### Exercise 2: When were one or both visited at least 12 times?
*When did LinkedIn views exceed 10 and did Facebook views fail to reach 10 for a particular day? Use the* `linkedin` *and* `facebook` *vectors.*

```{r and-or-vec-mat-ex-2, exercise=TRUE, exercise.setup="and-or-vec-mat-setup"}

```

```{r and-or-vec-mat-ex-2-solution}
linkedin >= 12 | facebook >= 12
```

```{r and-or-vec-mat-ex-2-check}
grade_code()
```

#### Exercise 3: When is views between 11 (exclusive) and 14 (inclusive)?
*When is the* `views` *matrix equal to a number between 11 and 14, excluding 11 and including 14?*

```{r and-or-vec-mat-ex-3, exercise=TRUE, exercise.setup="and-or-vec-mat-setup"}

```

```{r and-or-vec-mat-ex-3-solution}
views > 11 & views <= 14
```

```{r and-or-vec-mat-ex-3-check}
grade_code()
```

### Reverse the result: !

On top of the `&` and `|` operators, you also learned about the `!` operator, which negates a logical value. To refresh your memory, here are some R expressions that use `!`. They all evaluate to `FALSE`:

```{r not, exercise=TRUE}
!TRUE
!(5 > 3)
!!FALSE
```

```{r not-qu, echo=FALSE}
question(
  sprintf("What would the following set of R expressions return?\n
    x <- 5
    y <- 7
    !(!(x < 4) & !!!(y > 12))
    "),
  answer("TRUE"),
  answer("FALSE", correct = TRUE),
  answer("Running this piece of code would throw an error.")
)
```

### Blend it all together

With the things you've learned by now, you're able to solve pretty cool problems.

Instead of recording the number of views for your own LinkedIn profile, suppose you conducted a survey inside the company you're working for. You've asked every employee with a LinkedIn profile how many visits their profile has had over the past seven days. You stored the results in a data frame called `li_df`. This data frame is available in the workspace; type `li_df` in the console to check it out.

```{r blend-setup, echo=FALSE}
# Constructing the li_df data frame
employee_1 <- c(2, 3, 3, 6, 4, 2, 0)
employee_2 <- c(19, 23, 18, 22, 23, 29, 25)
employee_3 <- c(24, 18, 15, 19, 18, 22, 17)
employee_4 <- c(22, 18, 27, 26, 19, 21, 25)
employee_5 <- c(25, 25, 26, 31, 24, 36, 37)
employee_6 <- c(22, 20, 29, 26, 23, 22, 29)
employee_7 <- c(0, 4, 2, 2, 3, 4, 2)
employee_8 <- c(12, 3, 15, 7, 1, 15, 11)
employee_9 <- c(19, 22, 22, 19, 25, 24, 23)
employee_10 <- c(23, 12, 19, 25, 18, 22, 22)
employee_11 <- c(29, 27, 23, 25, 29, 30, 17)
employee_12 <- c(13, 13, 20, 17, 12, 22, 20)
employee_13 <- c(7, 17, 9, 5, 11, 9, 9)
employee_14 <- c(26, 27, 28, 36, 29, 31, 30)
employee_15 <- c(7, 6, 4, 11, 5, 5, 15)
employee_16 <- c(32, 35, 31, 35, 24, 25, 36)
employee_17 <- c(7, 17, 9, 12, 13, 6, 12)
employee_18 <- c(9, 6, 3, 12, 3, 8, 6)
employee_19 <- c(0, 1, 11, 6, 0, 4, 11)
employee_20 <- c(9, 12, 6, 13, 12, 13, 11)
employee_21 <- c(6, 15, 15, 10, 9, 7, 18)
employee_22 <- c(17, 17, 12, 4, 14, 17, 7)
employee_23 <- c(1, 12, 8, 2, 4, 4, 11)
employee_24 <- c(5, 8, 0, 1, 6, 3, 1)
employee_25 <- c(2, 7, 5, 3, 1, 5, 5)
employee_26 <- c(29, 25, 32, 28, 28, 27, 27)
employee_27 <- c(17, 15, 17, 23, 23, 17, 22)
employee_28 <- c(26, 32, 33, 30, 33, 28, 26)
employee_29 <- c(27, 29, 24, 29, 26, 31, 28)
employee_30 <- c(4, 1, 1, 2, 1, 7, 4)
employee_31 <- c(22, 22, 17, 20, 14, 19, 13)
employee_32 <- c(9, 11, 7, 10, 8, 15, 5)
employee_33 <- c(6, 5, 12, 5, 17, 17, 4)
employee_34 <- c(18, 17, 12, 22, 22, 13, 12)
employee_35 <- c(2, 12, 13, 7, 10, 6, 2)
employee_36 <- c(32, 26, 20, 23, 24, 25, 21)
employee_37 <- c(5, 13, 12, 11, 6, 5, 10)
employee_38 <- c(6, 10, 11, 6, 6, 2, 5)
employee_39 <- c(30, 37, 32, 35, 37, 41, 42)
employee_40 <- c(34, 33, 32, 35, 33, 27, 35)
employee_41 <- c(15, 19, 21, 18, 22, 26, 22)
employee_42 <- c(28, 29, 30, 19, 21, 19, 26)
employee_43 <- c(6, 8, 6, 7, 17, 11, 14)
employee_44 <- c(17, 22, 27, 24, 18, 28, 24)
employee_45 <- c(6, 10, 17, 18, 13, 10, 7)
employee_46 <- c(18, 19, 22, 17, 21, 15, 23)
employee_47 <- c(21, 27, 28, 28, 26, 17, 25)
employee_48 <- c(10, 18, 20, 18, 12, 19, 17)
employee_49 <- c(6, 15, 15, 15, 10, 14, 2)
employee_50 <- c(30, 28, 29, 31, 24, 20, 25)

li_df <- c(employee_1, employee_2, employee_3, employee_4, employee_5, 
           employee_6, employee_7, employee_8, employee_9, employee_10, 
           employee_11, employee_12, employee_13, employee_14, employee_15, 
           employee_16, employee_17, employee_18, employee_19, employee_20, 
           employee_21, employee_22, employee_23, employee_24, employee_25, 
           employee_26, employee_27, employee_28, employee_29, employee_30, 
           employee_31, employee_32, employee_33, employee_34, employee_35, 
           employee_36, employee_37, employee_38, employee_39, employee_40, 
           employee_41, employee_42, employee_43, employee_44, employee_45, 
           employee_46, employee_47, employee_48, employee_49, employee_50)

li_df <- matrix(li_df, nrow = 50, byrow = TRUE)

colnames(li_df) <- c("day1", "day2", "day3", "day4", "day5", "day6", "day7")

li_df <- data.frame(li_df)
```

```{r blend-ex-0, exercise=TRUE}

```

#### Exercise 1: Select the second column, named `day2`, from `li_df`: second
*Select the entire second column, named* `day2`*, from the* `li_df` *data frame as a vector and assign it to a new variable* `second`*.*

```{r blend-ex-1, exercise=TRUE, exercise.setup="blend-setup"}

```

```{r blend-ex-1-solution}
second <- li_df[, 2]
```

```{r blend-ex-1-check}
grade_code()
```

#### Exercise 2: Build a logical vector, TRUE if value in second is extreme: extremes
*Use* `second` *to create a logical vector, that contains* `TRUE` *if the corresponding number of views is strictly greater than 25 or strictly lower than 5 and* `FALSE` *otherwise. Store this logical vector as* `extremes`*.*

```{r blend-ex-2, exercise=TRUE, exercise.setup="blend-setup"}

```

```{r blend-ex-2-solution}
extremes <- second > 25 | second < 5
```

```{r blend-ex-2-check}
grade_code()
```

#### Exercise 3: Count the number of TRUEs in extremes
*Use* `second` *to create a logical vector, that contains* `TRUE` *if the corresponding number of views is strictly greater than 25 or strictly lower than 5 and* `FALSE` *otherwise. Store this logical vector in a new variable named* `extremes`*.*

```{r blend-ex-3, exercise=TRUE, exercise.setup="blend-setup"}

```

```{r blend-ex-3-solution}
sum(extremes)
```

```{r blend-ex-3-check}
grade_code()
```

#### Challenge: Solve it with a one-liner
*Write one line of R code that performs all of Exercises 1-3.*

```{r blend-ex-4, exercise=TRUE, exercise.setup="blend-setup"}

```

```{r blend-ex-4-solution}
sum(li_df[, 2] > 25 | li_df[, 2] < 5)
```

```{r blend-ex-4-check}
grade_code("This one liner illustrates that you may or may not need to store the second column as an intermediate variable if you only need to use it once. Head over to the next video and learn how relational and logical operators can be used to alter the flow of your R scripts.")
```

<div align="middle">

<!-- <video width="80%" controls src="./Videos/Chapter 01 - Lecture 03 - Conditional statements.mp4" type="video/mp4" /> -->

</div>

### The if statement

Before diving into some exercises on the `if` statement, have another look at its syntax:

```
if (condition) {
  expr
}
```

Remember your vectors with social profile views? Let's look at it from another angle. The `medium` variable gives information about the social website; the `num_views` variable denotes the actual number of views that particular `medium` had on the last day of your recordings. Both these variables have already been defined in the editor.

```{r if-setup}
# Variables related to your last day of recordings
medium <- "LinkedIn"
num_views <- 14
```

#### Exercise 1: Examine the if statement for `medium`
*Examine the* `if` *statement that prints out "Showing LinkedIn information" if the* `medium` *variable equals "LinkedIn".*

```{r if-ex-1, exercise=TRUE, exercise.setup="if-setup"}
if (medium == "LinkedIn") {
  print("Showing LinkedIn information")
}
```

#### Exercise 2: Write the if statement for `num_views`
*Code an* `if` *statement that prints "You're popular!" to the console if the num_views variable exceeds 15.*

```{r if-ex-2, exercise=TRUE, exercise.setup="if-setup"}

```

```{r if-ex-2-solution}
if (num_views > 15) {
  print("You're popular!")
}
```

```{r if-ex-2-check}
grade_code("Try to see what happens if you change the `medium` and `num_views` variables and run your code again. Let's further customize these if statements in the next exercise.")
```

### Add an else

You can only use an `else` statement in combination with an `if` statement. The `else` statement does not require a condition; its corresponding code is simply run if all of the preceding conditions in the control structure are `FALSE`. Here's a recipe for its usage:

```{r, eval=FALSE}
if (condition) {
  expr1
} else {
  expr2
}
```

*It's important that the* `else` *keyword comes on the same line as the closing bracket of the* `if` *part!*

Both `if` statements that you coded in the previous exercises are already available in the editor. It's now up to you to extend them with the appropriate `else` statements!

We'll start with the same setup as before:
```{r else-setup}
# Variables related to your last day of recordings
medium <- "LinkedIn"
num_views <- 14
```

#### Exercise 1: Control structure for `medium`
*Add an else statement such that "Unknown medium" gets printed out to the console when the if-condition on* `medium` *does not hold.*

```{r else-ex-1, exercise=TRUE, exercise.setup="else-setup"}

```

```{r else-ex-1-solution}
if (medium == "LinkedIn") {
  print("Showing LinkedIn information")
} else {
  print("Unknown medium")
}
```

```{r else-ex-1-check}
grade_code()
```

#### Exercise 2: Control structure for num_views
*Add an else statement such that R prints out "Try to be more visible!" when the if-condition on* `num_views` *is not met.*

```{r else-ex-2, exercise=TRUE, exercise.setup="else-setup"}

```

```{r else-ex-2-solution}
if (num_views > 15) {
  print("You're popular!")
} else {
  print("Try to be more visible!")
}
```

```{r else-ex-2-check}
grade_code("You also had Facebook information available, remember? Time to add some more statements to our control structures using `else if`!")
```

### Customize further: else if

The `else if` statement allows you to further customize your control structure. You can add as many `else if` statements as you like. Keep in mind that R ignores the remainder of the control structure once a condition has been found that is `TRUE` and the corresponding expressions have been executed. Here's an overview of the syntax to freshen your memory:

```{r, eval=FALSE}
if (condition1) {
  expr1
} else if (condition2) {
  expr2
} else if (condition3) {
  expr3
} else {
  expr4
}
```

*Again, it's important that the* `else if` *keywords comes on the same line as the closing bracket of the previous part of the control construct!*

We start again with the following variables pre-defined:
```{r else-if-setup}
# Variables related to your last day of recordings
medium <- "LinkedIn"
num_views <- 14
```

#### Exercise 1: Control structure for medium
*Add code to both control structures such that R prints out "Showing Facebook information" if* `medium` *is equal to "Facebook". Remember that R is case sensitive! Feel free to change the variable* `medium` *to see how the control structure responds. The existing code should be extended in the* `else if` *statement. No existing code should be modified.*

```{r else-if-ex-1, exercise=TRUE, exercise.setup="else-if-setup"}
if (medium == "LinkedIn") {
  print("Showing LinkedIn information")
} else {
  print("Unknown medium")
}
```

```{r else-if-ex-1-solution}
if (medium == "LinkedIn") {
  print("Showing LinkedIn information")
} else if (medium == "Facebook") {
  print("Showing Facebook information")
} else {
  print("Unknown medium")
}
```

```{r else-if-ex-1-check}
grade_code()
```

#### Exercise 2: Control structure for num_views
*Add code to both control structures such that "Your number of views is average" is printed if* `num_views` *is between 15 (inclusive) and 10 (exclusive). Feel free to change the variable* `num_views` *to see how the control structure responds. The existing code should be extended in the* `else if` *statement. No existing code should be modified.*

```{r else-if-ex-2, exercise=TRUE, exercise.setup="else-if-setup"}
if (num_views > 15) {
  print("You're popular!")
} else {
  print("Try to be more visible!")
}
```

```{r else-if-ex-2-solution}
if (num_views > 15) {
  print("You're popular!")
} else if (num_views <= 15 & num_views > 10) {
  print("Your number of views is average")
} else {
  print("Try to be more visible!")
}
```

```{r else-if-ex-2-check}
grade_code("Because R abandons the control flow as soon as it finds a condition that is met, you can simplify the condition for the `else if` part in the second construct to `num_views > 10`.")
```

### Else if 2.0

You can do anything you want inside if-else constructs. You can even put in another set of conditional statements. Examine the following code chunk:

```{r, eval=FALSE}
if (number < 10) {
  if (number < 5) {
    result <- "extra small"
  } else {
    result <- "small"
  }
} else if (number < 100) {
  result <- "medium"
} else {
  result <- "large"
}
print(result)
```

```{r if-else-qu, echo=FALSE}
question("Select all true statements below.",
  answer('If `number` is set to 6, "small" gets printed to the console.', correct = TRUE),
  answer('If `number` is set to 100, R prints out "medium".'),
  answer('If `number` is set to 4, "extra small" gets printed out to the console.', correct = TRUE),
  answer('If `number` is set to 2500, R will generate an error, as `result` will not be defined.')
)
```

**If you got this one right, the next exercise will be a piece of cake.**

### Take control!

In this exercise, you will combine everything that you've learned so far: relational operators, logical operators and control constructs. You'll need it all!

In the editor, we've coded two values beforehand: `li` and `fb`, denoting the number of profile views your LinkedIn and Facebook profile had on the last day of recordings. Go through the instructions to create R code that generates a 'social media score', `sms`, based on the values of `li` and `fb`.

```{r control-setup}
# Variables related to your last day of recordings
li <- 15
fb <- 9
```

#### Exercise 1: Control-flow construct
*Finish the control-flow construct with the following behavior:*

* *If both* `li` *and* `fb` *are 15 or higher, set* `sms` *equal to double the sum of* `li` *and* `fb`*.*
* *If both* `li` *and* `fb` *are strictly below 10, set* `sms` *equal to half the sum of* `li` *and* `fb`*.*
* *In all other cases, set* `sms` *equal to* `li + fb`*.*
* *Finally, print the resulting* `sms` *variable to the console.*

```{r control-ex-1, exercise=TRUE, exercise.setup="control-setup"}

```

```{r control-ex-1-solution}
if (li >= 15 & fb >= 15) {
  sms <- 2 * (li + fb)
} else if (li < 10 & fb < 10) {
  sms <- 0.5 * (li + fb)
} else {
  sms <- li + fb
}

sms
```

```{r control-ex-1-check}
grade_code("Feel free to play around some more with your solution by changing the values of `li` and `fb`.")
```

**You have finished the chapter "Conditionals and control flow"!**

## Loops

Loops can come in handy on numerous occasions. While loops are like repeated if statements; the for loop is designed to iterate over all elements in a sequence. Learn all about them in this chapter.

<div align="middle">

> **Document:** ["Slides - Loops"](./Slides/Chapter 02 - Loops.pdf)

</div>

<div align="middle">

<video width="80%" controls src="./Videos/Chapter 02 - Lecture 01 - While loop.mp4" type="video/mp4"/>

</div>

### Write a while loop

Let's get you started with building a `while` loop from the ground up. Have another look at its recipe:

```{r, eval=FALSE}
while (condition) {
  expr
}
```

Remember that the `condition` part of this recipe should become `FALSE` at some point during the execution. Otherwise, the `while` loop will go on indefinitely.  **If the "Run Code" button has a spinning icon, it is likely you are stuck in an infinite loop.  It will reset after about 30 seconds.**

#### Exercise: Write a while loop
*Have a look at the code below; it initializes the* `speed` *variables and already provides a* `while` *loop template to get you started. Code a* `while` *loop with the following characteristics:*

* *The condition of the* `while` *loop should check if* `speed` *is higher than 30.*
* *Inside the body of the* `while` *loop, print out* `"Slow down!"`*.*
* *Inside the body of the* `while` *loop, decrease the* `speed` *by 7 units. This step is crucial; otherwise your* `while` *loop will never stop.*

```{r loop-ex, exercise=TRUE}
# Initialize the speed variable
speed <- 64

# Code the while loop
while (___) {
  ___
}

# Print out the speed variable
speed
```

```{r loop-ex-solution}
# Initialize the speed variable
speed <- 64

# Code the while loop
while (speed > 30) {
  print("Slow down!")
  speed <- speed - 7
}

# Print out the speed variable
speed
```

```{r loop-ex-check}
grade_code("Proceed to the next exercise.")
```

### Throw in more conditionals

In the previous exercise, you simulated the interaction between a driver and a driver's assistant: When the speed was too high, "Slow down!" got printed out to the console, resulting in a decrease of your speed by 7 units.

There are several ways in which you could make your driver's assistant more advanced. For example, the assistant could give you different messages based on your speed or provide you with a current speed at a given moment.

#### Exercise: Throw in more conditionals
*A* `while` *loop similar to the one you've coded in the previous exercise is already available in the editor. It prints out your current speed, but there's no code that decreases the* `speed` *variable yet, which is pretty dangerous. Can you make the appropriate changes?*

* *If the speed is greater than 48, have R print out "Slow down big time!", and decrease the speed by* `11`*.*
* *Otherwise, have R simply print out "Slow down!", and decrease the speed by* `6`*.*

```{r more-ex, exercise=TRUE}
# Initialize the speed variable
speed <- 64

# Extend/adapt the while loop
while (speed > 30) {
  print(paste("Your speed is", speed))
  if (speed > 48) {
  } else {
  }
}
```

```{r more-ex-solution}
# Initialize the speed variable
speed <- 64

# Extend/adapt the while loop
while (speed > 30) {
  print(paste("Your speed is", speed))
  if (speed > 48) {
    print("Slow down big time!")
    speed <- speed - 11
  } else {
    print("Slow down!")
    speed <- speed - 6
  }
}
```

```{r more-ex-check}
grade_code("To further improve our driver assistant model, head over to the next exercise!")
```

### Stop the while loop with break

There are some very rare situations in which severe speeding is necessary: what if a hurricane is approaching and you have to get away as quickly as possible? You don't want the driver's assistant sending you speeding notifications in that scenario, right?

This seems like a great opportunity to include the `break` statement in the `while` loop you've been working on. Remember that the `break` statement is a control statement. When R encounters it, the `while` loop is abandoned completely.

#### Exercise: Stop the while loop with break
*Adapt the* `while` *loop such that it is abandoned when the* `speed` *of the vehicle is greater than 80. This time, the* `speed` *variable has been initialized to 88; keep it that way.*

```{r break-ex, exercise=TRUE}
# Initialize the speed variable
speed <- 88

while (speed > 30) {
  print(paste("Your speed is", speed))

  # Break the while loop when speed exceeds 80
  ___

  if (speed > 48) {
    print("Slow down big time!")
    speed <- speed - 11
  } else {
    print("Slow down!")
    speed <- speed - 6
  }
}
```

```{r break-ex-solution}
# Initialize the speed variable
speed <- 88

while (speed > 30) {
  print(paste("Your speed is", speed))

  # Break the while loop when speed exceeds 80
  if (speed > 80) {
    break
  }

  if (speed > 48) {
    print("Slow down big time!")
    speed <- speed - 11
  } else {
    print("Slow down!")
    speed <- speed - 6
  }
}
```

```{r break-ex-check}
grade_code("Now that you've correctly solved this exercise, feel free to play around with different values of `speed` to see how the `while` loop handles the different cases.")
```

### Build a while loop from scratch

The previous exercises guided you through developing a pretty advanced `while` loop, containing a `break` statement and different messages and updates as determined by control flow constructs. If you manage to solve this comprehensive exercise using a `while` loop, you're totally ready for the next topic: the `for` loop.

#### Exercise: Build a while loop from scratch
*Finish the* `while` *loop so that it:*

* *Prints out the triple of* `i`*, so* `3 * i`*, at each run.*
* *Loop is abandoned with a* `break` *if the triple of* `i` *is divisible by 8, but still prints out this triple before breaking.*

```{r while-scratch-ex, exercise=TRUE}
# Initialize i as 1 
i <- 1

# Code the while loop
while (i <= 10) {
  ___
  i <- i + 1
}
```

```{r while-scratch-ex-solution}
# Initialize i as 1 
i <- 1

# Code the while loop
while (i <= 10) {
  print(i * 3)
  if (i * 3 %% 8 == 0) {
    break
  }
  i <- i + 1
}
```

```{r while-scratch-ex-check}
grade_code("Head over to the next video!")
```

<div align="middle">

<video width="80%" controls src="./Videos/Chapter 02 - Lecture 02 - For loop.mp4" type="video/mp4"/>

</div>

### Loop over a vector

In the previous video, we told you about two different strategies for using the for loop. To refresh your memory, consider the following loops that are equivalent in R:

```{r, eval=FALSE}
primes <- c(2, 3, 5, 7, 11, 13)

# loop version 1
for (p in primes) {
  print(p)
}

# loop version 2
for (i in 1:length(primes)) {
  print(primes[i])
}
```

Remember our `linkedin` vector? It's a vector that contains the number of views your LinkedIn profile had in the last seven days. The `linkedin` vector has already been defined in the editor on the right so that you can fully focus on the instructions!

#### Exercise: Loop over a vector
*Write a* `for` *loop that iterates over all the elements of* `linkedin` *and prints out every element separately. Do this in two ways: using the **loop version 1** and the **loop version 2** in the example code above.*

```{r vector-loop-ex, exercise=TRUE}
# The linkedin vector has already been defined for you
linkedin <- c(16, 9, 13, 5, 2, 17, 14)

# Loop version 1

# Loop version 2

```

```{r vector-loop-ex-solution}
# The linkedin vector has already been defined for you
linkedin <- c(16, 9, 13, 5, 2, 17, 14)

# Loop version 1
for (view in linkedin) {
  print(view)
}

# Loop version 2
for (i in 1:length(linkedin)) {
  print(linkedin[i])
}
```

```{r vector-loop-ex-check}
grade_code("Please go to the next exercise.")
```

### Loop over a list

Looping over a list is just as easy and convenient as looping over a vector. There are again two different approaches here:

```{r, eval=FALSE}
primes_list <- list(2, 3, 5, 7, 11, 13)

# loop version 2
for (p in primes_list) {
  print(p)
}

# loop version 2
for (i in 1:length(primes_list)) {
  print(primes_list[[i]])
}
```

Notice that you need double square brackets - `[[ ]]` - to select the list elements in loop version 2.

Suppose you have a list of all sorts of information on New York City: its population size, the names of the boroughs, and whether it is the capital of the United States. We've already prepared a list `nyc` with all this information in the editor (source: Wikipedia).

#### Exercise: Loop over a list
*As in the previous exercise, loop over the nyc list in two different ways to print its elements:*

* *Loop directly over the* `nyc` *list (loop version 1).*
* *Define a looping index and do subsetting using double brackets (loop version 2).*

```{r list-loop-ex, exercise=TRUE}
# The nyc list is already specified
nyc <- list(pop = 8405837, 
            boroughs = c("Manhattan", "Bronx", "Brooklyn", "Queens", "Staten Island"), 
            capital = FALSE)

# Loop version 1

# Loop version 2

```

```{r list-loop-ex-solution}
# The nyc list is already specified
nyc <- list(pop = 8405837, 
            boroughs = c("Manhattan", "Bronx", "Brooklyn", "Queens", "Staten Island"), 
            capital = FALSE)

# Loop version 1
for (element in nyc) {
  print(element)
}

# Loop version 2
for (i in 1:length(nyc)) {
  print(nyc[[i]])
}
```

```{r list-loop-ex-check}
grade_code("We mentioned that `for` loops can also be used for matrices. Let's put that to a test in the next exercise.")
```

### Loop over a matrix

In your workspace below, we create a matrix `ttt`, that represents the status of a tic-tac-toe game. It contains the values "X", "O" and "NA". Print out `ttt` in the console so you can have a closer look. On row 1 and column 1, there's "O", while on row 3 and column 2 there's "NA".

```{r matrix-loop-setup, exercise = TRUE}
# Constructing tic-tac-toe matrix
ttt <- matrix(c("O", "NA", "X", "NA", "O", "O", "X", "NA", "X"), 
              nrow = 3, 
              byrow = TRUE)

# Print ttt here
```

To solve this exercise, you'll need a `for` loop inside a `for` loop, often called a nested loop. Doing this in R is a breeze! Simply use the following recipe:

```{r, eval=FALSE}
for (var1 in seq1) {
  for (var2 in seq2) {
    expr
  }
}
```

#### Exercise: Loop over a matrix
*Finish the nested* `for` *loops to go over the elements in* `ttt`*:*

* *The outer loop should loop over the rows, with loop index* `i` *(use* `1:nrow(ttt)`*).*
* *The inner loop should loop over the columns, with loop index* `j` *(use* `1:ncol(ttt)`*).*
* *Inside the inner loop, make use of* `print()` *and* `paste()` *to print out information in the following format: "On row i and column j the board contains x", where* `x` *is the value on that position.*

```{r matrix-loop-ex, exercise=TRUE, exercise.setup="matrix-loop-setup"}
# Define the double for loop

```

```{r matrix-loop-ex-solution}
# Define the double for loop
for (i in 1:nrow(ttt)) {
  for (j in 1:ncol(ttt)) {
    print(paste("On row", i, "and column", j, "the board contains", ttt[i,j]))
  }
}
```

```{r matrix-loop-ex-check}
grade_code("You're sufficiently comfortable with basic `for` looping, so it's time to step it up a notch!")
```

### Mix it up with control flow

Let's return to the *LinkedIn* profile views data, stored in a vector `linkedin`. In the first exercise on `for` loops you already did a simple printout of each element in this vector. A little more in-depth interpretation of this data wouldn't hurt, right? Time to throw in some conditionals! As with the `while` loop, you can use the `if` and `else` statements inside the `for` loop.

#### Exercise: Mix it up with control flow
*Add code to the* `for` *loop that loops over the elements of the* `linkedin` *vector:*

* *If the vector element's value exceeds 10, print out "You're popular!".*
* *If the vector element's value does not exceed 10, print out "Be more visible!"*

```{r flow-loop, exercise=TRUE}
# The linkedin vector has already been defined for you
linkedin <- c(16, 9, 13, 5, 2, 17, 14)

# Code the for loop with conditionals
for (li in linkedin) {
  ___
  print(li)
}
```

```{r flow-loop-solution}
# The linkedin vector has already been defined for you
linkedin <- c(16, 9, 13, 5, 2, 17, 14)

# Code the for loop with conditionals
for (li in linkedin) {
  if (li > 10) {
    print("You're popular!")
  } else {
    print("Be more visible!")
  }
  print(li)
}
```

```{r flow-loop-check}
grade_code("In the next exercise, you'll customize this `for` loop even further with `break` and `next` statements.")
```

### Next, you break it

In the editor below you'll find a possible solution to the previous exercise. The code loops over the `linkedin` vector and prints out different messages depending on the values of `li`.

In this exercise, you will use the `break` and `next` statements:

* The `break` statement abandons the active loop: the remaining code in the loop is skipped and the loop is not iterated over anymore.
* The `next` statement skips the remainder of the code in the loop, but continues the iteration.

#### Exercise: Next, you break it
*Extend the* `for` *loop with two new, separate* `if` *tests in the editor as follows:*

* *If the vector element's value exceeds 16, print out "This is ridiculous, I'm outta here!" and have R abandon the* `for` *loop (*`break`*).*
* *If the value is lower than 5, print out "This is too embarrassing!" and fast-forward to the next iteration (*`next`*).*

```{r break-for-ex, exercise=TRUE}
# The linkedin vector has already been defined for you
linkedin <- c(16, 9, 13, 5, 2, 17, 14)

# Extend the for loop
for (li in linkedin) {
  if (li > 10) {
    print("You're popular!")
  } else {
    print("Be more visible!")
  }
  # Add if statement with break
  ___
  
  # Add if statement with next
  ___
  
  print(li)
}
```

```{r break-for-ex-solution}
# The linkedin vector has already been defined for you
linkedin <- c(16, 9, 13, 5, 2, 17, 14)

# Extend the for loop
for (li in linkedin) {
  if (li > 10) {
    print("You're popular!")
  } else {
    print("Be more visible!")
  }
  # Add if statement with break
  if(li > 16){
    print("This is ridiculous, I'm outta here!")
    break
  }
  # Add if statement with next
  if(li < 5){
    print("This is too embarrassing!")
    next
  }
  print(li)
}
```

```{r break-for-ex-check}
grade_code("`for`, `break`, `next`? We name it, you can do it!")
```

### Build a for loop from scratch

This exercise will not introduce any new concepts on `for` loops.

In the editor on the right, we already went ahead and defined a variable `rquote`. This variable has been split up into a vector that contains separate letters and has been stored in a vector `chars` with the `strsplit()` function.

Can you write code that counts the number of r's that come before the first u in `rquote`?

#### Exercise: Build a for loop from scratch
*Initialize the variable* `rcount`*, as 0. Finish the* `for` *loop:*

* *if char equals* `"r"`*, increase the value of* `rcount` *by 1.*
* *if char equals* `"u"`*, leave the* `for` *loop entirely with a* `break`*.*
* *Finally, print out the variable* `rcount` *to the console to see if your code is correct.*

```{r build-loop-ex, exercise=TRUE}
# Pre-defined variables
rquote <- "r's internals are irrefutably intriguing"
chars <- strsplit(rquote, split = "")[[1]]

# Initialize rcount
___

# Finish the for loop
for (char in chars) {
  ___
}

# Print out rcount
___
```

```{r build-loop-ex-solution}
# Pre-defined variables
rquote <- "r's internals are irrefutably intriguing"
chars <- strsplit(rquote, split = "")[[1]]

# Initialize rcount
rcount <- 0

# Finish the for loop
for (char in chars) {
  if(char == "r") {
    rcount <- rcount + 1
  }
  if(char == "u") {
    break
  }
}

# Print out rcount
rcount
```

```{r build-loop-ex-check}
grade_code("This exercise concludes the chapter on `while` and `for` loops.")
```

**You have finished the chapter "Loops"!**
